# Структура ядра
## Основная иерархия
По возрастанию:
- ### Значения, минимально атомарная единица (Parameter):
    
    *Числа, строки, булевы значения*. Особые объекты типа [ModSystem](#система-модификаторов-modsystem), которые представляют из себя значение, формирующиеся из других значений
- ### Элемент (Game Element):
    
    Главное звено в структуре, отображающие какую-либо игровую сущность, которое является *хэш-таблицей* с определенными значениями, задаваемые **схемой**.
    
    **Схема** - это другая *хэш-таблица* с названиями полей и дефолтными значениями. Схему можно получить от двух источников: *табличную* и *индивидуальную*. Причем индивидуальная имеет больший приоритет

    Программно, **элемент** явно не описан - он создается и редактируется через **таблицу**
- ### Таблица (Table):

    Набор элементов управлюятся особым объектом - *хэш-таблицей*, которая предоставлеят функции для менеджемента элементов. Как правило таблица наследуется и модифицируется в соотвествии со сущностями, которыми она манипулирует.
- ### Игровые объекты (Game Object):
 
    Все таблицы объединяются в игровые объекты со сложной логикой. Эти объекты будут использоваться
    для представления данных и метаданных в интерфейсе. Каждый объект содержит регистр (registry), где указаны все его таблицы и элементы, которые могут быть задейственны в игре и соовтественно изменены.

## Система модификаторов (ModSystem)
Из-за непостоянной природы игры, игровые значения часто меняются вручную, что может вызывать конфликт с атвтоматикой. Поэтому необходима была система, решающая эту проблему.

Система модификаторов - это объект из нескольких хэш-таблиц. В одной содержат различные значения - **модификаторы**, простые числа, которые потом складываются в общее значние. Вторая таблица - это **флаги** эти самых **модификаторов**, которые описывают их опреденные технические особенности. Существующие флаги:
* readonly - только для чтения. Модификатор нельзя удалить или изменить. Нужен для системных формул

## Регистр (registry)
У [игровых объектов](#игровые-объекты-game-object) **_должен_** быть регистр, который является простой хэш-таблицей с игровыми параметрами объекта. Это нужно для двух целей:
* Парсинг в JSON
* Поиск [елемента](#элемент-game-element) в объекте

## Эффект (Effect)
Объект, воздействующий на [игровые объекты](#игровые-объекты-game-object). Позволеяет изменять объекты не прямо, а косвенно. На входе получает game object, на который будет воздействовать, и id [элемента](#элемент-game-element), находящегося в [регистре](#регистр-registry), а также сами, собственно говоря, изменения. На выходе мы получаем объект, который при своей инцилизации изменяет игровой объект. При деконструкции удаляет свое воздействие на объект. Имеет две вариации:
* Стандартная
* Временный

Типы эффекты:
* Модификаторный
    
    Добавляет модификатор к какому-нибудь игровому значению по id регистра

* Воздействие

    Изменение какого либо значения n раз с указанным шагом.

* Принт

    Для сложных эффектов некий текст пишиться в логи, чтобы мастер сам интепретировал значение этого эффекта

**Временный** также принимает [трекер времени](#временный-трекер), который использует для отслеживания игрового времени, чтобы потом по истечению указанного времени самоудалиться

## Глобальный контроллер
Глобальный контроллер игры хранится отдельно от объектов персонажей, и содержит в себе важные объекты и структуры, которые используются персонажами. Объекты содержащиеся в глобале:
* [Временный трекер](#временный-трекер)

## Временный трекер
Трекер отслеживает игровое время. Поскольку игра пошаговая, то вызывается метод *step*, который двигает время на указанное количество единиц. Также трекер содержит API для планирования задач.

# Игровые сущности
## Абстрактная сущность
Все игровые объекты должны следовать ряду требований, иначе ничего работать не будет:
* Регистр (registry)

## Игрок
Самая главная сущность, ведь в конце концов для кого делается игра. Вывод происходит через регистр, который предоставляет все параметры объекта, которые можно манипулировать. Ввод измненений происходит через пакеты изменний *(хэш-таблицей)*. Дается сам пакет изменений и тип изменения

Формат пакета:
```
{
    element: {
        parameter: change
    }
}
```

Типы изменений:
* SIMPLE - простое изменение простых значений (неизменяемые типы данных)
* Константы для комплексных значений
    * ADD - добавление значения
    * EDIT - изменение существующего значения
    * DEL - удаление значения

## Предметы
Любые сущности, которые можно хранить в инвентаре. Имеют множество разновидностей, но у всех у них есть ряд общих свойств:
* Название
* Тип (строка, разделенная запятыми, где сначала идет общий тип, а потом конкретный)
* Описание
* Вес
* Количество
* Экипируемый
* Особые свойства (Эффекты, которые задаются предметов)

Кроме обычного менеджемента в виде активных слотов, веса и другого, предметы способны влиять на персонажа посредством эффектов

### Типы предметов
Основные разновидности:
* Оружие
    * Урон
* Одежда, броня
    * AP
* Книги, записи
    * Прогресс изучения
* Пищи и расходники
    * Эффект воздействия
* Походные вещи
    * Эффект воздействия
